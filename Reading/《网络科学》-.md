# 《网络科学》

​                                                                                                                                                                     ——[美]艾伯特-拉斯洛·巴拉巴西

***

***Reading Note***：

***

[TOC]



## 网络和图

定义：

* 节点数N，表示系统中组成部分的个数。我们通常将N称为网络大小。

* 链接数L，表示节点间交互关系的总数。 

* 如果一个网络中所有的链接都是有向的，我们称之为有向网络或有向图。

* 度：度是节点的一个关键属性 ，表示该节点和其他节点之间的链接个数，用$k_i$表示网络中第i个节点的度。

  

  在无向网络中，总链接数L可以使用节点度之和：
  $$
  L = \frac12 \sum_{i=1}^{N}k_i
  $$
  平均度是网络的一个重要属性 ,在无向网络中 ，平均度被定义为:
  $$
  <k>=\frac1N \sum_{i=1}^{N}k_i=\frac{2L}{N}
  $$
  度分布$p_k$表示“网络中随机选出的一个节点其度为k”的概率.$\sum_{k=0}^{\infty}p_k=1$.

  对于N个节点的网络：$p_k=\frac{N_k}{N}$

  有向网络中：$k_i=k_{i}^{in}+k_{i}^{out}$ .

  即：

<img src="/assets/截屏2020-08-01 22.38.06.png" alt="截屏2020-08-01 22.38.06" style="zoom:50%;" />



定义：

邻接矩阵：一个拥有N个节点的有向网络，其邻接矩阵有N行N列，邻接矩阵的元素定义如下：如果存在一个链接从节点j指向节点i，则$A_{ij}=1$；如果节点i和节点j彼此不相连，则$A_{ij}=0$。



已知：真实网络是稀疏的。

理论上说（in theory),对于N个节点的无向网络，链接数的最大值为：$L_{max}=\frac{N(N-1)}{2}$

真实网络链接数远小于$L_{max}$.



加权网络，邻接矩阵的元素表示权重：$A_{ij}=w_{ij}$.



> 梅特卡夫定律指出，网络的价值与网络节点个数的平方（N2）成正比。一项互联网服务的价值和其能创造的链接数成正比，也就是和其用户数的平方成正比。相比而言，其成本和用户数（N）却只是线性相关。只要能够吸引足够多的用户，就一定能够赢利——随着N的增加，收益总会超过成本。
>
> **🚫** 1. 大多数网络是稀疏的，这意味着只有很小一部分链接会出现。因此，网络价值并非像N2那样增大，而是与网络大小N呈线性关系。
>
> 🚫 2.链接是有权重的，并不是所有链接的价值都一样。有些链接经常被使用，而绝大多数链接很少被使用。



二分网络

二分网络，其节点可以分成两个不相交的节点集合U和V，使得每个链接都连接着一个U中的节点和一个V中的节点。



路径：沿着网络中的链接行走经过的线路。

最短路径：两个节点间长度最短的路径

网络直径是网络中所有节点对之间的最大距离。（最短路径的最大长度）

平均路径长度：所有节点对之间最短路径的平均长度。（$<d>=(d_{1 \to 2}+d_{1\to 3}+d_{1 \to 4}+d_{1\to5}+d_{2\to 3}+d_{2\to4}+d_{2\to 5}+d_{3\to 4}+d_{3\to5}+d_{4\to5})/10$)

环：起始节点与终止节点相同的路径

欧拉路径：经过每条链接恰好一次的路径

汉密尔顿路径：经过每个节点恰好一次的路径



广度优先搜索算法（BFS）

标记为0的橙色节点出发，找出其所有邻居节点，并标记为1。接下来，对于标记为1的节点，找出其所有未标记的邻居节点，将其标记为2。在随后的迭代中，逐渐增加标记数，直到所有节点都被标记完为止。算法结束后，节点0和任意其他节点i之间的最短路径长度或者距离$d_{0i}$为节点i的标记。

  (1)  节点i出发，将其标记为0；
（2）找出与节点i直接相连的节点，标记为距离1，然后将它们放到一个队列中；
（3）从队列中取出最前面的节点（其距离标记假设为n），找出和该节点相连且尚未被标记的节点，将它们标记为n+1，然后把它们放在队列的后面；
（4）重复步骤3，直到碰到目标节点j或者队列中没有节点了；
（5）节点i和节点j之间的距离为节点j的标记。如果节点j没有标记，则$d_{ij}=\infty$



连通性：无向网络中，如果节点i和节点j之间存在一条路径，则它们是连通的。如果不存在路径（$d_{ij}=\infty$），则它们是不连通的。

如果一个网络的所有节点对都是连通的，我们说该网络是连通的。如果网络中至少有一对节点是不连通。



连通分支或簇：互不连通的子网络

桥：如果网络中包含两个连通分支，只需要选择合适的位置放置一个链接，就能使网络变成连通。



每一个方块对应着一个连通分支。我们可以使用线性代数工具来判定邻接矩阵是否是分块对角阵，从而找出网络的连通分支。



集散系数

对于一个度为$k_i$的节点$i$,其局部集散系数定义为：$C_i=\frac{2L_i}{k_i(k_i-1)}$.其中$L_i$表示节点$i$的$k_i$个邻居之间的链接数（拿掉节点$i$的链接数）

* $C_I=0$ 表示节点i的所有邻居彼此不相连
* $C_i=1$表示节点i的所有邻居形成完全图
* $C_i$表示任意两个邻居彼此相连的概率

平均集散系数：随机选择一个节点，其两个邻居彼此相连的概率。$<C>=\frac1N \sum_{i=1}^{N}C_i$.



## 随机网络

定义随机网络

$G(N,L)$:N个节点通过L条随机放置的链接彼此相连。

$G(N,p)$:N个节点，每对节点之间以p的概率相连。



Julia for $G(N,p)$:

```julia
using Plots
using GraphRecipes
function Graph_line(N, p)
    x = rand(N, N)
    for i in 1:N
        for j in 1:i
            if x[j, i] < p
                x[j, i] = 1
            else
                x[j, i] = 0
            end
            x[i, j] = x[j, i]
            x[i, i] = 0
        end
    end
    graphplot(x, curves=false)
end
Graph_line(100, 0.04)
```

<img src="/assets/截屏2020-06-04 16.35.06.png" alt="截屏2020-06-04 16.35.06" style="zoom:50%;" />

Math Analysis:

* L个节点之间存在链接的概率为$p^L$。
* 剩余$N(N-1)/2 -L$ 个点对之间没有链接的概率为$(1-p)^{\frac{N(N-1)}{2}-1}$
* 在所有$N(N-1)/2$个点对中选择L个点对放置链接，所以可能的选择方式$(_L^{N(N-1)/2})$.

二项式分布，随机网络的期望链接数：
$$
<L>=\sum_{L=0}^{\frac{N(N-1)}{2}}Lp_L=p\frac{N(N-1)}{2}
$$
二项分布的均值（一阶矩）：$x=\sum_{x=0}^{N}xp_x=Np$.

二阶矩：$x^2=\sum_{x=0}^{N}x^2p_x=p(1-p)N+p^2N^2$.



所以随机网络的平均度：$<k>=\frac{2<L>}{N}=p(N-1)$

平均距离：$<d>=\frac{lnN}{ln<k>}$.

度分布

随机网络一个节点i恰好有k个链接的概率：$p_k=(_k^{N-1})p^k(1-p)^{N-1-k}$.(极限情况，近似为柏松分布：$p_k=e^{-<k>}\frac{<k>^k}{k!}$)，局部集散系数：$C_i=\frac{2<L_i>}{k_i(k_i-1)}=p=\frac{<k>}{N}$.



真实网络不是柏松分布且是超临界的，随机网络不会出现枢纽节点。随机网络模型不能刻画真实网络的集聚特性，真实网络的平均集聚系数远远高于具有类似N和L的随机网络。



随着平均度￼从0增加到N-1，最大连通分支的大小是逐渐由$N_G=1$变化到$N_G=N$的。

一旦￼超过临界值($\langle K\rangle=1$ or $p=\frac1N$)，$N_G/N$开始迅速增加，标志着一个大的连通分支在快速形成，我们称该连通分支为巨连通分支.

1. 超临界状态$\langle k\rangle>1$ or $p>\frac1N$. 

2. 全连通状态：$\langle k\rangle>lnN$ or $p>\frac{lnN}{N}$.

![anim_15](/assets/anim_15.gif)

$N=100$, $p$ from 0.001 to 0.01



## 无标度性质



万维网度分布可以近似为：$p_k \sim k^{-\gamma}$.(幂律分布)
$$
logp_k \sim \gamma logk
$$


无标度网络是度分布服从幂律分布的网络。



Discrete:

节点的度是正整数：$k=0,1,2...$.
$$
p_k=Ck^{-\gamma}
$$
Because: $\sum p_k =1$. So: $C\sum_{k=1}^{\infty}k^{-\gamma}=1$.
$$
C = \frac{1}{\sum_{k=1}^{\infty} k^{-\gamma}}= \frac{1}{\zeta(\gamma)}
$$
离散的幂律分布：
$$
p_k = \frac{k^{-\gamma}}{\zeta(\gamma)}
$$
连续形式：
$$
\int_{k_{min}}^{\infty} p(k)dk=1
$$

$$
C = \frac{1}{\int_{k_{min}}^{\infty}k^{-\gamma}dk}=(\gamma-1)k_{min}^{\gamma -1}
$$

$$
p(k)=(\gamma-1)k_{min}^{\gamma-1}k^{-\gamma}
$$

枢纽节点

计算最大度$k_{max}$ (度分布$p_{k}$的自然截断)

假设$p(k)=Ce^{-\gamma k}$ ,N个节点的网络最多有一个节点位于$(k_{max},\infty)$内，观察到一个节点度超过$k_{max}$的概率为1/N：
$$
\int_{k_{max}}^{\infty}p(k)dk=\frac1N
$$
解得：$k_{max}=k_{min}+\frac{lnN}{\gamma}$

假设$p(k)=Ck^{-\gamma}$.

解得：$k_{max}=k_{min}N^{\frac{1}{\gamma -1}}$.



无标度网络中，枢纽节点不仅可以出现，而且必然出现.

无标度

Define :n 阶矩
$$
\langle k^{n}\rangle=\sum_{k_{min}}^{\infty}k^{n}p_k\approx \int_{k_{min}}^{\infty}k^{n}p(k)dk
$$
n=1:一阶矩是平均度（平均值）

n=2:二阶矩计算方差

n=3:三阶矩体现度分布的偏斜，反映了度分布pk在平均度￼附近的对称程度

对于无标度网络的n阶矩：
$$
\langle k^{n} \rangle=\int_{k_{min}}^{k_{max}}k^{n}p(k)dk=C\frac{k_{max}^{n-\gamma +1}-k_{min}^{n-\gamma+1}}{n-\gamma+1}
$$
$n-\gamma+1\le0$,$k_{max}^{n-\gamma+1}$会随着$k_{max}$增大趋近于零，因此度分布的矩是有限的

$n-\gamma+1>0$, $k_{max}\to \infty$,趋向于无穷大，因此度分布的矩发散。

随机网络有标度

度服从$\gamma <3$的幂律分布，是无标度的。

无标度：基础设施网络（互联网），生物网络（蛋白质相互作用网络）、通信网络（电子邮件网络），以及描述学术交流的网络（引文网络）

判断是否为无标度：

1. 绘制度分布
2. 测量度指数



$\gamma=2$,异常状态：$\langle k\rangle=const$,最大枢纽节点的度随系统大小成线性增长，即$k_{max}\sim N$。网络呈现出以一个枢纽节点为中心的星型结构。所有节点相距都很近，因为这些节点都与同一个中心枢纽节点相连。在这种状态下，平均路径长度与N无关。

$2<\gamma<3$,超小世界：$\langle k\rangle = lnlnN$ 枢纽节点通过连接大量的小度节点使彼此之间距离变短，从而大大缩短了路径长度

$\gamma=3$, 临界点状态：$\langle k \rangle=\frac{lnN}{lnlnN}$.

$\gamma>3$,小世界：$\langle k \rangle=lnN$.

无标度性质对网络距离的影响：

1. 降低平均路径长度
2. 改变$\langle d \rangle$ 对系统大小的依赖关系
3. 只有$\gamma>3$时，随机网络小世界性质才会出现。



生成给定度序列的网络：每个节点具有预先定义好的度ki，除此之外，网络是随机相连的。

Algorithm :

1. 度序列为每个节点赋予一个度，表示其拥有的“端”数或“半链接”数
2. 随机选择一对端进行连接。然后，在剩下的2L-2个端中再随机选取一对进行连接。重复该过程，直到所有的端都匹配成功(有些网络包含回路（图b），有些网络包含自环（图c）或多重链接（图d）。然而，在N→∞的极限情况下，自环和多重链接的期望数量趋近于0。)





## 巴拉巴西-阿尔伯特模型

网络

- 是一个增长的产物，节点N会增加。

- 节点倾向于链接数高的节点相连。

巴拉巴西-阿尔伯特模型：最简单的、可以生成幂律度分布的网络生长模型。

Use  mathematica to show:

```mathematica
RandomGraph[BarabasiAlbertGraphDistribution[10^2, 2]]
```

![BarabasiAlbertGraph(100,2)](/assets/BarabasiAlbertGraph(100,2).svg)

- 生长：每个时间步，向网络中添加一个m条链接的新节点
- 偏好链接：新节点每次选择节点链接时，选择度为$k_i$的节点进行链接的概率为：$P=\frac{k_i}{\sum_j k_j}$

经过t个时间步后，巴拉巴西－阿尔伯特模型生成了一个网络节点数为$N=t+m_0$、链接数为$N=m_0+mt$的网络

度动力学：

一个连续实数变量来近似$k_i$，该变量可以理解为$k_i$在很多次网络生长过程中的平均值

节点i获得新链接的速率：
$$
\frac{dk_i}{dt}=m\frac{k_i}{\sum_{j=1}^{N-1} k_j}
$$
new node will take m links, so node i have m chance to ge links.

So $\sum_{j=1}^{N-1}k_j=2mt-m$

且$k_i(t_i)=m$.节点i在时刻ti加入网络时拥有m个链接

$$
\begin{align}
\frac{dk_i}{dt} &=\frac{k_i}{2t-1}
\end{align}
$$

t取值很大，分子中-1忽略

解得：$k_i(t)=m(\frac{t}{t_i})^{\beta}$.     $\beta=\frac12$.

> 结论：
>
> 1. 节点度按幂律增长，并且有相同的动态指数$\beta=\frac12$,节点遵循同样增长规律
> 2. 度的增长是亚线性的,随着时间积累，每个节点会与更多的节点竞争被连接的机会。
> 3. 节点i越早加入网络，它的度$k_i(t)$就越高,枢纽节点之所以度很高，是因为它们比其他节点更早加入网络。这种现象在营销和商业领域被称为先发优势。
> 4. 节点i获得新链接的速率:$\frac{dk_i(t)}{dt}=\frac m2 \frac{1}{\sqrt{t_it}}$.(即15的导数)，所以每个时间步，节点越老，获得的链接就越多。进一步，节点获得链接的速率随着时间下降$t^{-1/2}$。随着时间推移，每个节点获得链接的数目会越来越少



度分布

计算度小于k的节点数量，即$k_i(t)<k$。

$k_i(t)=m(\frac{t}{t_i})^{\beta}$ , 即：$t_i <t(\frac{m}{k})^{1/\beta}$.

每个时间步新加入一个节点。因此，度小于k的节点数量为：$t(\frac{m}{k})^{1/\beta}$

总共有$N=m_0+t$,when t to large so $N\approx t$.

从数轴上看

$m_0$,........................................................$t(\frac mk)^{1/\beta}$............................$t$

一个随机选择的节点，其度小于或等于k的概率记为累积度分布$P(k)=1-(\frac{m}{k})^{1/\beta}=1-\frac{t(\frac{m}{k})^{1/\beta}}{N}$

度分布即导数：$p_k=\frac{\partial P(k)}{\partial k}=\frac{1}{\beta}\frac{m^{1/\beta}}{k^{1/\beta+1}}=2m^2k^{-3}$

正好是：$p(k)\approx 2m^{1/\beta}k^{-\gamma}$.		其中：$\gamma=\frac{1}{\beta}+1=3$



生成无标度网络的机制：生长和偏好连接都需要

**Proof**：

假如只生长，随机链接（在每个时间步，我们添加一个拥有m条链接的新节点，使之与网络中已经存在的m个节点相连）

一个新节点和度为ki的节点相连的概率为（随机连接）：$\Pi(k_i)=\frac{1}{m_0+t-1}$

根据连续介质理论可以推出，模型A中ki(t)随时间呈对数增长:
$$
k_i(t)=mln(e\frac{m_0+t-1}{m_0+t_i-1})
$$
比幂律增长要慢得多。模型所得的度分布服从指数分布:$p(k)=\frac em exp(-\frac{k}{m})$

指数函数要比幂函数的衰减快得多，此时网络中很难出现枢纽节点

假如只偏好连接，不生长，在每个时间步，随机选择一个节点，该节点和其他节点相连时，选择度为$k_i$的节点的概率可根据公式4.1$P=\frac{k_i}{\sum_j k_j}$得到。由于Π(0)=0，我们假设度k=0的节点的度为k=1，否则这些节点无法获得链接。

在模型B中，网络中的节点数目在网络演化过程中保持不变，而链接数随时间呈线性增长,当t很大时，每个节点的度也随时间呈线性增长$k_i(t) \approx \frac{2}{N}t$.

在早期，网络中只有少数几个链接（即L[插图]N），此时每个新链接会连接两个之前没有任何链接的节点。在这个阶段，模型B的演化和m=1时的巴拉巴西－阿尔伯特模型没有区别。数值模拟表明，在这个阶段，模型B得到的度分布服从幂律分布.pk不是稳定的。实际上，短暂的一段时间过后，节点度开始收敛到平均度公式即上式。当t→N(N-1)/2时，网络变成了一个完全图——图中所有节点的度都是kmax=N-1，此时有pk=δ(N-1)。



偏好依赖的假设：

1. 一个节点被连接的概率$\Pi(k)$取决于它的度k
2. $\Pi(k)$和$k$是线性关系

测量：

我们知道同一个网络在两个不同时刻的结构。第一个时刻记为$t$，第一个时刻记为$t+∆t$.节点$i$的度变化量为$\Delta k_i = k_i(t+\Delta t_i)-k_i(t)$.则：$\frac{\Delta k_i}{\Delta t_i} \sim \Pi(k_i)$.累计偏好函数：$\pi(k)=\sum_{k_i=0}^{k}\Pi(k_i)$.

当偏好连接不存在时，Π(ki)是常数。因此，$π(k) \sim k$。如果存在线性偏好连接，即Π(ki)=ki，我们有$π(k)\sim k^2$。
$$
\Pi(k)\sim k^\alpha
$$

1. $\alpha =0$:无偏好连接
2. $0<\alpha <1$:亚线性连接
3. $\alpha =1$:线性偏好连接
4. $\alpha >1$:超线性连接



偏好连接的起源：

- 链接选择模型：网络通过添加新节点而生长，每个新节点在加入时会随机选择一条链接；新节点以相同的概率从该链接的两个端点中选择一个与之相连；
  		1. 一条随机选择的链接，其端点的度为k的概率为：$q_k=Ckp_k$.(节点的度越高，该节点就越容易成为随机选择的链接的一端,网络中度为k的节点越多)
    		2. 因为$\sum q_k=1$,得出$C = 1/\langle k \rangle$.
    		3. 所以：$q_k=\frac{kp_k}{\langle k \rangle}$.概率qk和k是线性关系。表明，链接选择模型通过产生偏好连接构造出了无标度网
- 复制模型：新节点以概率p连接到一个随机选择的目标节点u，或者以概率1-p连接到节点u指向的某个节点。
  	1. 随机连接：新节点以概率p连接到节点u，即我们连接到随机选择的网页。
   	2. 复制：我们以概率1-p随机选择节点u的一条出边，让新节点连接到这条边的另一端
   	3. 选择到某个特定节点的概率是1/N，步骤（2）等价于选择了一个随机选择的链接所指向的节点进行连接。对于无向网络，通过复制步骤（2），选择到度为k的节点的概率为k/2L。
   	4. 综合：$\Pi(k)=\frac pN + \frac{1-p}{2L}k$,
- 优化模型：新节点i选择节点进行连接时，其成本函数为：$C_i=min_j[\delta d_{ij}+h_j]$.$d_{ij}$是节点i与节点j之间的欧氏距离，$h_j$是节点j和“网络中心”之间的“网络距离”.
  	1. 星型网络$δ＜（1 / 2)^{1/2}$
   	2. 随机网络$δ≥N^{1/2}$
   	3. 无标度网络$4≤δ≤N^{1/2}$
   	4. 无标度拓扑结构

***

> ◉ 推导过程：
>
> 设$N(k,t)$表示时间为$t$时，度为$k$的节点数量，则度分布$p_k(t)$和$N(k,t)$的关系为：
> $$
> p_k(t)=\frac{N(k,t)}{N(t)}
> $$
> 由于我们在每个时间步向网络中添加一个新节点，因此有$N=t$。也就是说，在任意时刻，节点总数都等于时间步数。
>
> 偏好连接：
> $$
> \Pi(k)=\frac{k}{\sum_j k_j}=\frac{k}{2mt}
> $$
> 2m：无向网络中每条链接对两个节点的度有贡献.
>
> 1. 新节点连接到了度为k的节点，使它的度变成了$(k+1)$，从而减小了$N(k,t)$.
> 2. 新节点连接到了度为$(k-1)$的节点，使它的度变成了$k$，从而增大了$N(k,t)$.
>
> 新节点加入后，连接到度为k节点的链接数为:
> $$
> \frac{k}{2mt}\times Np_k(t)\times m=\frac k2 p_k(t)
> $$
> 第一项刻画了新节点连接到度为k的节点的概率（偏好连接);第二项是度为k的节点数：度为k的节点数越多，新节点连接到一个度为k的节点的概率越大；第三项是新节点的度：m越大，新节点连接到度为k的节点的机会越多。
>
> 1. 原来度为k、后来因获得一条新链接而变成度为(k+1)的节点数量为:$\frac k2 p_k(t)$
> 2. 原来度为(k-1)、后来因获得一条新链接而变成度为k的节点数量为:$\frac{k-1}{2} p_{k-1}(t)$
>
> 增加新节点后度为k的节点的期望数量:
> $$
> (N+1)p_k(t+1)=Np_k(t)+\frac{k-1}{2}p_{k-1}(t)-\frac k2 p_k(t)
> $$
> 适用于所有度k>m的节点。由于网络中没有度为k=0,1,…,m-1的节点（每个新节点的度为m），对于度为m的节点，我们还需要一个单独的公式.
> $$
> (N+1)p_m(t+1)=Np_m(t)+\frac{k-1}{2}p_m(t)-\frac k2 p_m(t)
> $$
> $N=t→∞$的极限下有$p_k(∞)=p_k$:
>
> 所以：
> $$
> (N+1)p_k(t+1)-Np_k(t)\to Np_k(\infty)+p_k(\infty)-Np_k(\infty)=p_k(\infty)=p_k
> $$
> So:
> $$
> p_k=\frac{k-1}{2}p_{k-1}(t)-\frac k2 p_k(t)
> $$
> So:
> $$
> p_k=\frac{k-1}{k+2}p_{k-1},\quad k > m
> $$
> use k+1 to k,:
> $$
> p_{k+1}=\frac{k}{k+3}p_{k}
> $$
> Same:
> $$
> p_m=\frac{2}{m+2}
> $$
> 最小度k=m的度分布，然后利用公式递推计算出更大度时的pk:
> $$
> p_{m+1}=\frac{m}{m+3}p_m=\frac{2m}{(m+2)(m+3)}\\
> p_{m+2}=\frac{m+1}{m+4}p_{m+1}=\frac{2m(m+1)}{(m+2)(m+3)(m+4)}\\
> p_{m+3}=\frac{m+2}{m+5}p_{m+2}=\frac{2m(m+1)}{(m+3)(m+4)(m+5)}
> $$
> 将分母中的m+3替换为k，便得到了观察到度为k的节点的概率：
> $$
> p_k=\frac{2m(m+1)}{k(k+1)(k+2)}
> $$
> 巴拉巴西－阿尔伯特模型度分布的精确形式.

***

> ◉ 推导非线性偏好连接：
>
> 非线性巴拉巴西－阿尔伯特模型中，每个时间步新增加一个节点，新节点带来$m$条新链接。每条新链接将新节点和网络中已经存在的一个节点相连，新节点连接到度为$k_i$的节点的概率为:
> $$
> \Pi(k_i)=\frac{k_{i}^{\alpha}}{M(\alpha, t)}
> $$
> And $0<\alpha \le 1$:
> $$
> M(\alpha, t)=t\sum_{k}k^{\alpha}p_k(t)=t\mu(\alpha.t)
> $$
> $t=N(t)$表示节点数:
> $$
> \mu(0,t)=\sum_{k}p_k(t)=1 \quad \mu(1,t)=\sum_{k}kp_k(t)=\langle k \rangle=2mt/N
> $$
> So:
> $$
> \mu(0,t)<\mu(\alpha,t)\le \mu(1,t)
> $$
> 时间趋于无穷大时:
> $$
> \mu(\alpha,t \to \infty)=const
> $$

***

## 演化网络



节点适应性：节点具有某种使其脱颖而出的内在属性。

为比安科尼－巴拉巴西模型（适应性模型）：假设偏好连接取决于节点的适应性η和节点度k的乘积。

1. 生长：每个时间步，网络中加入一个新的节点$j$，该节点具有$m$条链接和适应性$\eta$.$\eta_i$是从适应性分布$\rho(\eta)$中采样得到的一个随机数。
2. 偏好连接：一个新的节点连接到节点$i$的概率正比于节点的度$k_i$和适应性$\eta_i$的乘积：$\Pi_i=\frac{\eta_i k_i}{\sum_{j} \eta_j k_j}$。

节点$i$的度变化速度为：$\frac{\partial k_i}{\partial t}=m\frac{\eta_i k_i}{\sum_{j}\eta_j k_j}$.

假设$k_i$的时间演化服从幂指数$\beta(\eta_i)$依赖于其适应性的幂律分布：
$$
k(t,t_i,\eta_i)=m(\frac{t}{t_i})^{\beta(\eta_i)}
$$
计算$\langle \sum_j \eta_j k_j \rangle$:
$$
\langle \sum_j \eta_j k_j \rangle=\int \rho(\eta)\eta d\eta \int_{1}^{t}k_{\eta}(t,t_i)d t_i
$$
将$k_{\eta}(t,t_i)$替换为（35），积分可得：
$$
\langle \sum_j \eta_j k_j \rangle=\int\rho(\eta)\eta d\eta m \frac{t-t^{\beta(\eta)}}{1-\beta(\eta)}
$$

- 节点的度只能随着时间增长，所以$\beta(\eta)>0$,而且$k_i(t)$不会比$t$增长得快，故$\beta(\eta)<1$. So $\beta(\eta) \in (0, 1)$.

所以:
$$
m \frac{t-t^{\beta(\eta)}}{1-\beta(\eta)}=mt\times \frac{1}{1-\beta(\eta)}\times(1-t^{\beta(\eta)-1})
$$
当$t \to \infty$,$t^{\beta(\eta)}$与$t$相比可以忽略：
$$
\langle \sum_j\eta_jk_j\rangle ^{t \to \infty}=Cmt(1-O(t^{-\epsilon}))
$$
其中$\epsilon = (1-max_{\eta} \beta(\eta))>0$,$C=\int\rho(\eta)\frac{\eta}{1-\beta(\eta)}d \eta$.

所以：
$$
\frac{\partial k_{\eta}}{\partial t}=\frac{\eta k_{\eta}}{Ct}
$$
这样解得，如（35）的形式，$\beta(\eta)=\frac{\eta}{C}$.证实了假设是自洽的.



1. 等适应性：比安科尼－巴拉巴西模型退化为巴拉巴西－阿尔伯特模型（所有$\eta=1,\rho(\eta)=\delta(\eta-1)$)
2. 均匀分布的适应性：我们假设η均匀分布于区间[0,1]上，$C=\int\rho(\eta)\frac{\eta}{1-\beta(\eta)}d \eta$ 得$exp(-2/C)=1-1/C$.



$k(t,t_i,\eta_i)=m(\frac{t}{t_i})^{\beta(\eta_i)}$取对数：$lnk(t,t_i,\eta_i)=\beta(\eta_i)lnt+ln(\frac{m}{t_i^{\beta(\eta_i)}})$

放大效应：适应性的微小差异会被网络生长机制和偏好连接机制放大。

同时考虑两个同时进入网络的节点，具有不同的适应性$\eta_2>\eta_1$.两者相对差异随着时间：$\frac{k_2-k_1}{k_1} \sim t^{\frac{\eta_2-\eta_1}{C}}$.



**For Example**:

通常来说，一篇科研论文i在发表后的t时刻被引用的概率是:
$$
\Pi_i \sim \eta_i c_i^{t}P_{i}(t)
$$
论文的适应性$η_i$表示论文中的科学发现的新颖性和重要性；$c_i^{t}$是论文i在发表后的t时刻之前累计被引用的次数，用于刻画“被引用较多的论文比被引用较少的论文更有可能被引用”这一偏好连接现象.$P_i(t)$论文的新颖性随时间衰减的趋势——论文的新颖性会因后续相关论文的发表而逐渐衰减.实际测量表明，这一衰减过程服从对数正态的形式：
$$
P_i(t)=\frac{1}{\sqrt{2\pi t \sigma_i}}e^{-\frac{(lnt-\mu_i)^2}{2\sigma_i^{2}}}
$$
Solution 41, we can get a function about t:
$$
c_i^{t}=m(e^{\frac{\beta\eta_i}{A}\phi(\frac{lnt-\mu_i}{\sigma_i})}{}-1)
$$
Among them:
$$
\phi(x)=\frac{1}{\sqrt{2\pi}}\int_{-\infty}^{x} e^{-y^2/2}dy
$$
最终影响力可以通过计算每一年$t$（某些时间段，年，或月）该篇文章的引用数$y$,最终影响力为$\int_{t_0}^{\infty} ydt$



### 玻色－爱因斯坦凝聚(Bose Einstein condensate)

玻色气体（图5-7），一个粒子处于能级$ε_i$的概率是：
$$
\Pi_i=\frac{e^{-\beta_{T}\varepsilon_i}k_i}{\sum_j e^{-\beta_{T}\varepsilon_j}k_j}
$$
因此，能级为$\varepsilon_i$上的粒子数增长速度为：
$$
\frac{\partial k(\varepsilon_i,t,t_i)}{\partial t}=m\frac{e^{-\beta_{T}\varepsilon_i}k_i(\varepsilon_i,t,t_i)}{Z_t}
$$
Among them $k_i(\varepsilon_i,t,t_i)$ is the number of particles on energy level $\varepsilon_i$
$$
Z_t=\sum_{j=1}^{t}te^{-\beta_{T}\varepsilon_j}k_j(\varepsilon_i,t,t_i)
$$
Solution for 46:
$$
k_i(\varepsilon_i,t,t_i)=m(\frac{t}{t_i})^{f(\varepsilon_i)}, \quad f(\varepsilon)=e^{-\beta_{T}(\varepsilon-\mu)}
$$
$\mu$是化学势，满足：
$$
\int deg(\varepsilon)\frac{1}{e^{\beta_T(\varepsilon-\mu)}-1}=1
$$
deg（ε）是能级ε的简并度。方程49意味着在t→∞的极限条件下，能级为ε的粒子数服从玻色统计量:
$$
n(\varepsilon)=\frac{1}{e^{\beta_{T}(\varepsilon-\mu)}-1}
$$
将网络类比与玻色气体：

- 适应性等于能量：适应性为ηi的每个节点赋予一个能量εi，赋值方式为$\varepsilon_i=\frac{1}{\beta_t}log\eta_i$.(在物理系统中，βT表示温度的倒数)。
- 链接等于粒子：对应于从节点i指向节点j的每条链接，我们有一个处于能级εj的粒子。
- 节点等于能级：一个具有m条链接的新节点加入网络，对应于在玻色气体中增加一个新的能级εj和m个新粒子。



将比安科尼－巴拉巴西模型映射到玻色气体，有些适应性分布会导致网络中出现玻色－爱因斯坦凝聚，所有的粒子聚集到最低能级，其他能级全部为空。

一个网络如果要发生玻色－爱因斯坦凝聚，其适应性分布需要满足如下条件：
$$
\int_{\eta_{min}}^{\eta_{max}}\frac{\eta \rho(\eta)}{1-\eta}d\eta <1, \rho(\eta)=(1-\zeta)(1-\eta)^{\zeta}
$$
玻色－爱因斯坦凝聚意味着最大适应性的节点拥有全部链接的很大一部分，会成为一个超级枢纽节点。



1. 初始吸引力：真实网络存在初始吸引力，通过对$\Pi(k)$的测量
   	1. 增大度指数
    	2. 导致低饱和度
2. 内部链接
3. 节点删除：在每个时间步，我们增加一个具有m条链接的新节点，并且以速率r删除一个节点。根据r的取值不同观察到三种形态：无标度，指数，衰退
   	1. 无标度：$r<1$,
    	2. 指数：$r=1$
    	3. 衰退网络:$r>1$
4. 节点删除➕初始吸引：网络会在无标度网络和指数网络之间发生相变
5. 加速增长：假设在增长网络中，每个新节点带来的链接数服从$m(t)=m_0t^{\theta}$.





## 度相关性



- 中性网络:枢纽节点之间的链接数量$p=\frac{k k'}{2L}$.
- 同配网络：枢纽节点倾向于彼此相连，而非连接到小度节点，同时小度节点倾向于连接到其他小度节点。
- 异配网络：枢纽节点倾向于彼此不相连，而是连接到小度节点。



度相关性矩阵表达网络的度相关性信息，每个元素$e_{ij}$表示随机选择一条链接，其两端点的度分别为$i$和$j$的概率。$e_{ij}$是概率$\sum_{i,j} e_{ij}=1$.

随机选择的一条链接有一个端点度为k的概率:$q_k=\frac{kp_k}{\langle k \rangle}$

$q_k$与$e_{ij}$可以联系起来:$\sum_j e_{ij}=q_i$

对于随机连接的中性网络，我们期望:$e_{ij}=q_iq_j$



简洁的方法来量化度相关性:计算每个节点i的邻居的平均度
$$
k_{nn}(k_i)=\frac{1}{k_i}\sum_{j=1}^{N}A_{ij}k_j
$$
对所有度为k的节点计算度相关性函数
$$
k_{nn}(k)=\sum_{k'}k'P(k'|k)
$$
$P(k′|k)$指对于一个度为$k$的节点，存在一个度为$k′$的节点与之相连的条件概率



对于中性网络：
$$
P(k'|k)=\frac{e_{kk'}}{\sum_{k'}e_{kk'}}=\frac{q_{k'}q_k}{q_k}=q_{k'}
$$

$$
k_{nn}(k)=\sum_{k'}k'q_{k'}=\sum_{k'}k'\frac{k'p(k')}{\langle k \rangle}=\frac{\langle k^2 \rangle}{\langle k \rangle}
$$

利用下式来近似度相关性函数$k_{nn}(k)=ak^{\mu}$

- 同配网络：knn(k)随k递增,$\mu >0$
- 中性网络：$\mu=0$,
- 异配网络：$\mu<0$



> 度相关性系数由马克·纽曼提出，定义为：
> $$
> r=\sum_{jk} \frac{jk(e_{jk}-q_jq_k)}{\sigma^2}\\
> \sigma^2=\sum_k k^2q_k-[\sum_k kq_k]^2
> $$
> 取值范围为$-1≤r≤1$：$r>0$时，网络是同配的；$r=0$时，网络是中性的；$r<0$时，网络是异配的





## 网络鲁棒性

> 要移除多少个节点，我们才能把一个网络分解成一些相互独立的连通分支？

**渗透理论**

渗流理论是统计物理学和数学领域衍生出的一个成熟的分支领域[2-5]。图7-4a、b展示了一个典型的渗流理论可以解决的问题。在方形网格的每个交叉点上，我们以一定的概率p来放置石子。我们认为相邻的石子相互连接，两个或两个以上相互连接的石子形成簇（cluster）。鉴于每个石子放置的位置是随机的，我们提出以下问题：

```julia
using Plots
 function percolation_picture(N,P)
     x = []
     y = []
     A = rand(N,N)
     for i in 1:N
         for j in 1:N
             if A[i, j] < P
                 append!(x,i)
                 append!(y,j)
             end
         end
     end
     scatter(x,y)
     plot!(xlims = (0, N+1), ylims = (0, N+1), xticks = 1:1:N, yticks = 1:1:N)
 end
```

p=0.1:

<img src="/assets/percolation(p=0).png" alt="percolation(p=0)" style="zoom:25%;" />

p=0.7:

<img src="/assets/percolation(p=0.7).png" alt="percolation(p=0.7)" style="zoom:25%;" />

当$p$升高到一个临界值$p_c$时，这些小簇会增长并且凝聚，促使产生一个大簇。当这个大簇扩张到网格的边缘时，我们称之为渗流簇（percolatingcluster）。换言之，在临界值$p_c$，我们观察到相变——许多小簇凝聚成一个可以渗透整个网格的渗流簇



- 当概率p较小时，大部分石子是孤立的。在这种情况下，最大的簇只有3个
- 当概率p较大时，大部分（但不是全部）石子属于一个单一的簇，仍用紫色标识。这个簇被称为渗流簇，它贯穿了整个网格
- 簇的平均规模[插图]与概率$p$的函数。当我们从左侧逼近$p_c$时，很多小的簇凝聚在一起，[插图]发散，正如公式7.1所示。当从右侧逼近$p_c$时，也有同样的情况（$\langle s \rangle \sim |p-p_c|^{-\gamma_p}$)
- 序参量，随机选择一个石子，序参量P∞是这个石子属于最大簇的概率，（$P_{\infty} \sim (p-p_c)^{\beta_p}$)
- 关联长度，同一簇的两颗石子之间的平均距离，（$\xi \sim |p-p_c|^{-v}$),当$p<p_c$时，同一簇石子之间的距离是有限的。当$p=p_c$时，这个距离是发散的。这意味着，在临界点$p_c$，最大簇的规模是无穷大的，因而可以渗流整个网格



临界阀值 $f_c=1-\frac{1}{\frac{\langle k^2 \rangle}{\langle k \rangle}-1}$

其中$f$代表随机移除节点的比例。

==对于$γ<3$的无标度网络来说，它的二阶矩在$N\to ∞$的时候是发散的,所以$f_c$收敛到1.即要想分解一个无标度网络，我们必须移除它所有的节点==

$$
\begin{equation}
f_c=\left\{
\begin{aligned}
 & 1-\frac{1}{\frac{\gamma-2}{3-\gamma}k_{min}^{\gamma-2}k_{max}^{3-\gamma}-1} ,\quad 2<\gamma<3\\
 & 1-\frac{1}{\frac{\gamma-2}{3-\gamma}k_{min}-1},\quad \gamma>3 \\
\end{aligned}
\right.
\end{equation}
$$

- $\gamma>3$,临界阀值$f_c$只取决于$\gamma$和$k_{min}$,与网络规模无关。
- $\gamma<3$,$k_{max}$在$N$比较大时会发散，在$N\to \infty$时，$f_c$趋近于1。



考虑有限网络鲁棒性：
$$
f_c=1-\frac{C}{N^{\frac{3-\gamma}{\gamma-1}}}
$$


考虑攻击枢纽节点，依次去除最大度的枢纽节点，移除一小部分枢纽节点能够使得整个网络分解为小的互联通分支。

无标度网络受到如上攻击时的临界阈值$f_c$是下述方程的解：
$$
f_c^{\frac{2-\gamma}{1-\gamma}}=2+\frac{2-\gamma}{3-\gamma}k_{min}(f_c^{\frac{2-\gamma}{1-\gamma}}-1)
$$


- 在随机故障中，临界值$f_c$随$γ$的增加而单调减小。但在攻击下，$f_c$并非单调的：当$γ$较小时，$f_c$随$γ$的增加而增加，但当$γ$较大时，$f_c$随$γ$的增加而减小。
- 攻击下的$f_c$总是小于随机故障的$f_c$



**极联故障**：一个局部变化引发了一系列事件，进而传播到整个系统。（停电，拒绝服务攻击，金融危机，。。。）



发生级联现象的系统具备以下三个关键因素：

1. 系统可以被描述为一个存在流量的网络，就像电网中的电流或者通信网络中的信息流
2. 每个连通分支都存在一种局域故障规则，它决定了一个连通分支何时会参与到级联现象中去。参与的形式可能是发生故障（比如电网、地震）或者选择传播某一条信息
3. 在连通分支遇到故障或者被激活时，系统有重新分配流量的机制。



故障传播模型：

一个任意度分布的网络，每个节点都有一个代理（agent）。代理i可以存在两种状态：状态0（活跃或者正常）和状态1（不活跃或者故障）。每个代理i都有一个故障阈值$φ_i=φ$。

在t=0时，一个代理的状态变为1，代表最初的一个组件故障，或者最初发布的一条新信息。之后的每一步中，我们随机地选取一个代理，并根据阈值法则来更新它的状态：

- 如果该代理i的状态为0，那么它将根据其邻居的状态做出更新：如果$k_i$个邻居中至少有$ϕ$比例的邻居的状态为1，那么代理i将改变状态为1，也就是说，代理i也发生故障；否则，代理i保持状态为0。
- 如果该代理i的状态为1，那么它的状态不变。

情况：

1. 次临界情形，$\langle k \rangle$较高，节点邻居较多，影响不会扩散
2. 超临界状态，$\langle k \rangle$较低，改变单个节点会导致级联
3. 临界情形，次临界与超临界的交界，级联规模可大可小

分支模型，该模型从单个活跃节点开始，在之后的每一个步中，每个活跃节点产生k个后代，其中k由概率分布pk生成。如果一个节点生成了k=0，那么这个分支就结束了（图7-21b）。如果一个节点生成了k>0，它将会产生k个新的活跃后代。当所有活跃节点的分支都结束时，这个树的规模就是级联事件的规模,情形由$\langle k \rangle$决定：

1. 次临界情形，$\langle k \rangle<1$
2. 超临界状态，$\langle k \rangle>1$
3. 临界情形,$\langle k \rangle=1$



如何设计具有鲁棒的网络？

为了增强网络的鲁棒性，我们需要提高$f_c$的值,$f_c$取决于$\langle k^2\rangle$和$\langle k \rangle$,在保持成本$\langle k \rangle$(链接数)不变的情况下，最大化$f_c$要求最大化$\langle k^2 \rangle$.

可以通过双峰分布来实现：网络只有两类节点，一类节点的度都是$k_{min}$，另一类节点的度都是$k_{max}$.

结论：对随机故障和攻击都鲁棒的网络应该只有一个度为$k_{max}$的枢纽节点，而其他节点的度都为$k_{min}$.

<img src="/assets/截屏2020-08-17 21.43.06.png" alt="截屏2020-08-17 21.43.06" style="zoom:50%;" />

> 拉撒路效应:想让一个无法生长和繁殖的已“死”细菌复活，只需删除几个精心挑选的基因,受控的损害反而对网络有利。一个必需基因丢失，生物质流为零，此时大肠杆菌无法再繁殖。然而，如果再移除另外5个基因，却可以重新激活生物质流。



## 社区

在网络科学中，如果一组节点内部链接紧密，外部链接稀疏，那么我们称这组节点为一个社区（community）

假设：

H1:基础假设：网络的社区结构仅由其连接模式决定。

H2:连通性和密度假设：社区中的节点更倾向于连接到同一社区内的其他节点，而非其他社区的节点；每个社区对应一个连通子图。

H3:随机连接的网络没有内在社区结构。

H4:给定一个网络，模块度最大的划分对应最优的社区结构。



定义强社区和弱社区：

网络的一个具有$N_c$个节点的连通子图C,节点i的内部度$k_i^{int}$是i与C中其他节点的链接数，外部度$k_i^{ext}$是i与网络中其他节点（不属于子图C的节点）的链接数。

强社区：其节点指向同一社区内其他节点的链接多于指向其他社区的节点的链接。(for each i in C,have :$k_i^{int}(C)>k_i^{ext}(C)$)

弱社区：其节点的总内部度高于总外部度。(for each i in C,have: $\sum k_i^{int}(C)>\sum k_i^{ext}(C)$)

社区数目问题

图的二划分（graph bisection）问题：将一个网络分成两个不重叠的子图，使得两部分节点之间的链接数（被称为割集的大小）最小.（Kerninghan-Lin算法）

？NP-完全性问题？

**劳沃斯算法**

1. 定义相似度矩阵：矩阵的每个元素xij表示节点i和节点j之间的距离，拓扑重叠矩阵的公式：$x_{i,j}^{0}=\frac{J(i,j)}{min(k_i,k_j)+1-\theta(A_{ij})}$,其中$\theta(A_{ij})$是赫维赛德阶跃函数（Heaviside step function），当$x\leq 0$时，取0，当$x>0$时，取1。$J(i,j)$是$i$和$j$的公共邻居数，且当i和j之间直接相连时取值加1，$min(k_i,k_j)$是$k_i$和$k_j$较小度。

<img src="/assets/截屏2020-08-18 14.26.29.png" alt="截屏2020-08-18 14.26.29" style="zoom:50%;" />

- $x_{i,j}=0$:节点i和j没有公共邻居且并不相连
- $x_{i,j}=1$:节点i和j直接相连且所有邻居都是公共邻居

For example: $x_{K,H}=\frac{2}{2+1-0}=\frac 23$

2. 确定节点组的相似度:度量两个社区之间的相似度,三种常用方法（单一簇相似度（single clustersimilarity）、完全簇相似度（complete cluster similarity）和平均簇相似度（average cluster similarity））

<img src="/assets/截屏2020-08-18 14.36.32.png" alt="截屏2020-08-18 14.36.32" style="zoom:50%;" />

a. 相似度矩阵,表中给出了每对节点之间的距离$r_{ij}$，即相似度$x_{ij}$。

b.单连接聚类,社区1和2之间的相似度定义为所有xij中的最小值，其中i和j分属不同社区。因此相似度为$x_{12}=1.59$

c.完全连接聚类,两个社区之间的相似度定义为所有xij中的最大值，其中i和j分属不同社区。因此$x_{12}=3.97$

d.平均连接聚类,两个社区之间的相似度定义为所有xij中的平均值，其中i和j分属不同社区

3. 执行层次聚类
   1. 将每个节点视为一个社区，计算所有节点对之间的$x_{ij}$.
   2. 寻找相似度最高的两个节点或两个社区，然后合并为一个社区。
   3. 计算新的社区与其他所有社区的相似度。
   4. 重复（1）和（2）直到所有节点都并入同一社区
4. 树状图,用树状图来选取合理的社区结构。



**分裂算法**

链接介数(link betweenness)，定义$x_{ij}$为通过链接(i,j)的最短路径的数目。连接不同社区的链接的$x_{ij}$应该较大，而社区内的链接的$x_{ij}$应该较小



由H3，通过比较社区的链接密度和随机网络（对这个社区内的节点进行随机重连）的链接密度，可以判断出这个社区是真实存在的密集子图，还是偶然生成的连通模式。

***模块度***

一个有N个节点和L条链接的网络。想象有一种划分，可以得该网络划分成$n_c$个社区，每个社区有$N_c$个节点，节点之间用$L_c$条链接相连，其中$c=1,…,n_c$。给定网络的度序列。根据H2密度假设的推论，若$L_c$大于$N_c$个节点之间链接的期望数，那么子图$C_c$的节点可能确实是一个真实社区的一部分（图8-2）。因此，我们可以度量网络的真实连接模式（$A_{ij}$）和随机连接时i和j的期望链接数（$p_{ij}$）之间的差异:
$$
M_c=\frac {1}{2L} \sum_{(i,j) \in C_c}(A_{ij}-p_{ij})
$$
$p_{ij}$,通过随机化原网络来计算，同时保持每个节点的度的期望不变。根据保度零模型（degree preserve null model)
$$
p_{ij}=\frac{k_ik_j}{2L}
$$
若$M_c$为正，那么子图$C_c$的链接多于随机连接的期望链接数，则它可能是一个社区。

若$M_c$为零，那么这$N_c$个节点之间的连接是随机的，可以由度分布完全解释。

若$M_c$为负，那么$C_c$的节点不构成社区。


$$
M_c=\frac{L_c}{L}-(\frac{k_c}{2L})^2
$$
其中$L_c$是社区$C_c$内的链接数，$k_c$是该社区的节点的度的总和。

考虑一个完整的划分（completepartition），把网络划分为nc个社区。我们定义这个划分的模块度为公式8.11在所有nc个社区上进行的求和，以观察该划分定义的各个子图的局部链接密度与随机连接网络的期望密度之间的差异
$$
M=\sum_{c=1}^{n_c}M_c=\sum_{c=1}^{n_c}[\frac{L_c}{L}-(\frac{k_c}{2L})^2]
$$

- 高模块度表示好的划分



## 传播模型

基于2个假设：

1. 可划分性：易感染（S），已感染（I），已康复（R）
2. 均匀混合性：每个个体都以相同的概率接触以感染的个体

**SI model**

个体处于S或I状态，接触感染率为$\beta$,个体单位时间有$k$个可接触对象

if $I(t=0)=1$
$$
\frac{dI}{dt}=\beta k \frac{S(t)}{N}I(t)
$$
$I(t)$:$t$时刻已感染人数

$\beta k$:单个感染人数可接触到并传播的人数

$\frac{S(t)}{N}$:接触中为感染的比例

记$i=\frac{I}{N},s=\frac{S}{N}$,则$i+s=1$,($i$为感染的比例)
$$
\frac{di}{dt}=\beta k (1-i)i
$$
初始条件:$i_0=i(t=0)=\frac{I(t=0)}{N}$

解得：
$$
i = \frac{i_0 e^{\beta k t}}{1-i_0+i_0e^{\beta k t}}
$$
**SIS model**

Define:康复率为$\mu$.
$$
\frac{di}{dt}=\beta k (1-i)i-\mu i
$$
初始条件:$i_0=i(t=0)=\frac{I(t=0)}{N}$

解得：
$$
i = (1-\frac{\mu}{\beta k})\frac{Ce^{(\beta k-\mu)t}}{1+Ce^{(\beta k- \mu)t}}
$$
$C=\frac{i_0}{1-i_0-\frac{\mu}{\beta k}}$



**SIR model**
$$
\frac{ds}{dt}=-\beta k i [1-r-i]\\
\frac{di}{dt}=\beta ki[1-r-i]-\mu i \\
\frac{dr}{dt}=\mu i
$$
